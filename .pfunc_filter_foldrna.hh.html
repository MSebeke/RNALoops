&quot;pfunc_filter_foldrna.hh&quot;: complete probabilistic shape analysis (see <a href="http://www.biomedcentral.com/1741-7007/4/5/">Complete probabilistic analysis of RNA shapes</a>) has to deal with the huge number of shape classes for an RNA sequence. Many of those classes contain only very few structures, which furthermore have only a low partition function value and thus hardly contribute to the overall partition function value. While violating Bellman's Principle of Optimality, filtering out low probability shape classes at the beginning of the computation yields surprisingly good results and is a significant speed up. Default threshold is 10^-6.
You can use this filter when defining an instance, via <span class="code">suchthat pfunc_filter</span>; for <span class="code">alg_shapeX * alg_pfunc</span> products or <span class="code">suchthat pfunc_filter_allPP</span> for <span class="code">(alg_shapeX * (alg_mfe % alg_pfunc)) * alg_dotBracket</span> products. Unfortunately, the filter depends on the concrete answer tuple of the product, thus it is not very generic.