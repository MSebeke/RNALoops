for pseudoknots, we need a canonicalization to accomplish an acceptable polynomial runtime. One of these canonicalizations is the assumption, that a stem of a pseudoknot must be of maximal length and cannot have interruptions like bulges or internal-loops. The (energetically) best stems for subwords i,j are precomputed in n^2 with the function &quot;stacklen&quot;.