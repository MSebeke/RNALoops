&quot;singlefold.hh&quot; is a little hack to save code duplication. The only difference between a grammar for single sequence input and alignment input is the base-pairing filter. We use the special <span class="code">basepair</span> function, which does different things for both input types. For the single sequence input it just calls the GAP build-in basepairing filter.