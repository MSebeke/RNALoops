Evaluating the energy for given sequence and structure becomes a two track problem. The concept is identical to gra_nodangle.gap but now we need two track terminal parses like <BASE, CHAR('.')> for an arbitrary nucleotide that shall remain unpaired. Currently, GAP-C is not able to handle a terminal parser for a specific character (CHAR('.')) within the multitrack context, thus we use the non-terminals isBase, isOpen and isClose.
The &quot;samesize&quot; filter guarantees that the same number of characters is parsed on both tracks, but it does not yield optimized code. We can dramatically increase speed if we manually modify loops in the generated code, i.e. one loop is completely unnecessary.