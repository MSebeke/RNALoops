Evaluating the energy for given sequence and structure becomes a two track problem. The concept of &quot;Grammars/gra_eval_nodangle&quot; is identical to <a href="?id=gra_nodangle.gap">Grammars/gra_nodangle.gap</a> but now we need two track terminal parses like <code>&lt;BASE, CHAR('.')&gt;</code> for an arbitrary nucleotide that shall remain unpaired. Currently, GAP-C is not able to handle a terminal parser for a specific character (<code>CHAR('.')</code>) within the multitrack context, thus we use the non-terminals <code>isBase</code>, <code>isOpen</code> and <code>isClose</code>.
The <code>samesize</code> filter guarantees that the same number of characters is parsed on both tracks, but it does not yield optimized code. We can dramatically increase speed if we manually modify loops in the generated code, i.e. one loop is completely unnecessary.