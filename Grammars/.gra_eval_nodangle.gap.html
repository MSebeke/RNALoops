Evaluating the energy for given sequence and structure becomes a two track problem. The concept of &quot;gra_eval_nodangle&quot; is identical to <a href="?id=gra_nodangle.gap">gra_nodangle.gap</a> but now we need two track terminal parses like <span class="code">&lt;BASE, CHAR('.')&gt;</span> for an arbitrary nucleotide that shall remain unpaired. Currently, GAP-C is not able to handle a terminal parser for a specific character <span class="code">(CHAR('.'))</a> within the multitrack context, thus we use the non-terminals isBase, isOpen and isClose.
The &quot;samesize&quot; filter guarantees that the same number of characters is parsed on both tracks, but it does not yield optimized code. We can dramatically increase speed if we manually modify loops in the generated code, i.e. one loop is completely unnecessary.