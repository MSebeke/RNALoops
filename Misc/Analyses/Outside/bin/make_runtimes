grammar=nodangle
GAPC=gapc
MAKE=make
PERL=perl
BASEDIR=../../../../
RNAOPTIONSPERLSCRIPT=../../../Applications/addRNAoptions.pl
CXXFLAGS_EXTRA=-O3 -DNDEBUG
FASTLIBRNA=

outname=out
PROGRAMPREFIX=

TARGETDIR=/vol/cluster-data/sjanssen/bin/

all: obwe ibwe mfepp

obwe:
	$(GAPC) -I $(BASEDIR) -p "alg_outside_pfunc" $(BASEDIR)outside_$(grammar).gap
	$(PERL) $(RNAOPTIONSPERLSCRIPT) out.mf 0
	$(MAKE) -f out.mf CPPFLAGS_EXTRA="-I $(BASEDIR) -I ./" CXXFLAGS_EXTRA="$(CXXFLAGS_EXTRA)" $(FASTLIBRNA)
	mv out $(TARGETDIR)/oa_o_nodangle_pfunc
	
ibwe:
	$(GAPC) -I $(BASEDIR) -p "alg_pfunc" $(BASEDIR)$(grammar).gap
	$(PERL) $(RNAOPTIONSPERLSCRIPT) out.mf 0
	$(MAKE) -f out.mf CPPFLAGS_EXTRA="-I $(BASEDIR) -I ./" CXXFLAGS_EXTRA="$(CXXFLAGS_EXTRA)" $(FASTLIBRNA)
	mv out $(TARGETDIR)/oa_i_nodangle_pfunc
	
mfepp:
	$(GAPC) -I $(BASEDIR) -p "alg_mfe * alg_dotBracket" --kbacktrace --no-coopt $(BASEDIR)$(grammar).gap
	$(PERL) $(RNAOPTIONSPERLSCRIPT) out.mf 0
	$(MAKE) -f out.mf CPPFLAGS_EXTRA="-I $(BASEDIR) -I ./" CXXFLAGS_EXTRA="$(CXXFLAGS_EXTRA)" $(FASTLIBRNA)
	mv out $(TARGETDIR)/oa_i_nodangle_mfepp
	
clean:
	rm -f *.cc *.d *.hh *.o *.mf
	rm -f string.*

