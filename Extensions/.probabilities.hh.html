<p>The number of shape classes grows exponentially with sequence length. Thus, correct computation becomes infeasible for sequences of length around 120 bases. However, many of those shape classes have only a very small probability. The rational behind the &quot;low probability filter&quot; is to omit those classes and concentrate only on the important once. This makes probability computation practical, but it also becomes heuristical. Due to the bottom up fashion of ADP, we have to make the decision of keeping a shape class directly at its initial creation, i.e. if we only see the hairpin loops. Computation of shape class probabilities violate Bellman's Principle of Optimality, because it might be that a classe with an initial poor probability could have become the most likely if it had the chance to &quot;grow&quot;, i.e. when considering the whole input, not just the hairpin sub-sequence. </p>
<p>&quot;probabilities.hh&quot; is the implementation of the &quot;low probability filter&quot; for all different cases like pseudoknots or macrostates.</p>