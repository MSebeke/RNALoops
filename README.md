![example branch parameter](https://github.com/jlab/fold-grammars/actions/workflows/c-cpp.yml/badge.svg)

# fold-grammars
Collection of bgap code for RNA folding
For rudimentary documentation, consult https://bibiserv.cebitec.uni-bielefeld.de/fold-grammars/

# RNA-Loops

This is a forked repository from the original fold-grammars that I use as a framework for PhD Project RNALoops. RNALoops is a extensions of the base secondary structure prediction algorithm that implements classified dynamic programming, which was developed and implemented by Björn Voß.
RNALoops with it's instance ```motmfepretty``` is at base a minimum free energy RNA secondary structure prediction algorithm that has the added feature of recognizing RNA 3D Motifs in the sequence. The motifs are taken from the Bowling Green State Universities RNA 3D Motif Atlas, which has to be done before using RNALoops. The motif collection is semi-automated through the ```RNAMotifs.py``` Python script which can be found in the Extensions. In order to make this script work as intended, the user needs to download the newest motif sets from the BGSU RNA 3D Motif Atlas in .json format (individually) and move them into ```./RNALoops/Extensions/Data/```. This folder should then contain three files: ```hl_3.xx.json```, ```il_3.xx.json``` and the premade ```Loop_List.txt file```. Running ```RNAMotifs``` then populates ```./RNALoops/Extensions/Loops/``` with three new .csv files, which should contain all the sequences for each motif together with the later used single letter abbreviations. The motifs are split into three categories, based on how the macrostate grammar also classifies RNA Loop types: Hairpin Loops, Internal Loops and Bulge Loops.

With the pre-set up done, the RNALoops.gap can now be compiled with the gapc compiler. My recommended compiler arguments would be: ```-t --kbacktrace --kbest -i motmfepretty```. After the gapc finished one last step is required for RNALoops to work properly: The generated "make file", by default if no other name was given through compiler arguments ```out.mf```, has to be edited. Specifically the CXX files have to be extended by one additional file: ```Extensions/RNAMotifs/motif.cc```. Now the user can use ```make -f out.mf``` to compile the executeable that, by default, will only be called ```out```. Now calling ```./out [insert your RNA sequence here]``` the algorithm will return an Answer comprised of indvidual predictions classified by the motifs they contain. Additionally, there is also a partition function incorporated through the instance ```motpfc```, which classifies all possible structures into classes based on the motifs they contain and sums up the partition function values of all memebers of a class.

If anything should not work for you when trying to implement RNALoops, please feel free to reach out to me through my public e-mail. Thanks for using my work!
