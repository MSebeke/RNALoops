![example branch parameter](https://github.com/jlab/fold-grammars/actions/workflows/c-cpp.yml/badge.svg)

# fold-grammars
Collection of bgap code for RNA folding
For rudimentary documentation, consult https://bibiserv.cebitec.uni-bielefeld.de/fold-grammars/

# RNALoops

This is a forked repository from the original fold-grammars that I use as a framework for my PhD Project RNALoops. RNALoops is a extensions for the secondary structure prediction algorithm that implements classified dynamic programming based on RNA 3D motifs. RNALoops is made up of multiple parts: Multiple algebras, the ```motif.hh``` header and a motif collecting tool ```RNAMotifs.py```.
The algebras can be found in ```./RNALoops/Agebras/Motif```. ```alg_motif``` enables the detection of RNA 3D Motif sequences and classifies secondary structure prediction candidates with them. ```alg_pretty``` is a version of the basic ```alg_dotBracket``` that includes the detected in the dotBracket depiction of the secondary structure. Two additional functionalities are implemented through ```alg_shapes_mot.gap``` and ```alg_hishapes_mot.gap```. These are basically merged versions of the existing shapes and hishapes algebras with my motif implementation which adds additional information into their outputs. To be exact the found abstract shapes of RNA are enhanced with information of whether the marked loops contain a motif. For additional information on how the original shapes and hishapes algorithms work, please refer to their respective publications (Shapes: [1] R. Giegerich, B. Voß, and M. Rehmsmeier, ‘Abstract shapes of RNA’, Nucleic Acids Res, vol. 32, no. 16, pp. 4843–4851, 2004, doi: 10.1093/nar/gkh779, additional information here: [1] B. Voß, R. Giegerich, and M. Rehmsmeier, ‘Complete probabilistic analysis of RNA shapes’, BMC Biology, vol. 4, no. 1, p. 5, Feb. 2006, doi: 10.1186/1741-7007-4-5. HiShapes: [1] J. Huang, R. Backofen, and B. Voß, ‘Abstract folding space analysis based on helices’, RNA, vol. 18, no. 12, pp. 2135–2147, Dec. 2012, doi: 10.1261/rna.033548.112)

The ```motif.hh``` header file can be found in ```./RNALoops/Extensions/```, it contains the necessary C++ function declarations and definitions to implement RNA 3D motif detection. Finally the motif collection tool ```RNAMotifs.py``` is findable under ```./RNALoops/Misc/Applications/RNAMotifs/```. ```RNAMotifs.py``` takes motif sequences from the Bowling Green State Universities RNA 3D Motif Atlas and saves them in .csv files under ```./RNALoops/Misc/Applications/RNAMotifs/Loops/``` (Attention in the current version this folder does not exist when downloading this repo, you have to manually add it!) . For this it uses a curated list of BGSU identifiers and their single letter abbreviations as well as the (optimally current) .json files for both Hairpin loops and Internal loops, downloadable from the BGSU RNA 3D Motif Atlas websites for Hairpin Loops and Internal Loops respectively. The curated motif list is saved under ```./RNALoops/Misc/Applications/RNAMotifs/Data/Loop_List.txt```, while both the .json files need to be downloaded by the user and stored in the ```./RNALoops/Misc/Applications/RNAMotifs/Data/``` folder.
A premade program is avaiable as RNALoops.gap in the main directory ```./RNALoops/```.

Work in progress: Add the loops folder permanently, implement motifs from the RMFAM RNA Motif database that RFAM uses for annotating the RNA families with motifs, make the setup easier (and automated or something ?).
RNA Motifs from the RFAM database have been implemented on my local repo but are not quite ready, so this functionality will be added soonish.

If anything should not work for you when trying to implement RNALoops, please feel free to reach out to me through my public e-mail. Thanks for using my work!
