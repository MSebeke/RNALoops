&quot;Algebras/Pfunc/alg_pfunc.gap&quot; computes the partition function value for a candidate. Choice function is sum, to add up all individual partition function values. Let x be the free energy of a structure, R the universal gas constant, T the temperature in Kelvin then the partition function value is exp(-x/R*T). One could say, partition function is <i>just</i> a scaling of free energy. The function <code>mk_pf()</code> does this scaling. To avoid overflows the partition function values are scaled by the number of bases in the input sequence, i.e. the number of bases in a substructure; function <code>scale()</code>. The energy values themselves are identical to the MFE algebras, but they are multiplied instead of summed.
The probability of a structure is its partition function value divided by the sum of the partition function values of all structures in the search space.
<br/>
<br/>
Since algebra functions are commonly used by other algebras (<a href="?id=alg_pknot_pfunc.gap">Algebras/Pfunc/alg_pknot_pfunc.gap</a> and <a href="?id=alg_outside_pfunc.gap">Algebras/Pfunc/alg_outside_pfunc.gap</a>), they are outsourced in the file <a href="?id=algpart_pfunc_basic.gap">Algebras/Pfunc/algpart_pfunc_basic.gap</a>.
